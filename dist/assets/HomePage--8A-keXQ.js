import{f as N,c as i,d as o,r as w,j as e}from"./index--VjYBowS.js";import{S as E,M as C}from"./shopping-bag-Db8YJ_SC.js";import{P as p}from"./plus-BB5vrTSW.js";import{I as T}from"./image-mf86drFn.js";function I({storageId:n,imageUrl:d,name:t}){const c=i(o.files.getImageUrl,n?{storageId:n}:"skip")||d;return c?e.jsx("img",{src:c,alt:t,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center",children:e.jsx(T,{className:"w-16 h-16 text-gray-400"})})}function k(){const{addToCart:n,updateQuantity:d,selectedTimeslotId:t,setSelectedTimeslotId:x,selectedLocationId:c,setSelectedLocationId:u,cartItems:y,cartItemCount:f}=N(),g=i(o.timeslots.list),j=i(o.locations.list),h=i(o.items.getItemsByTimeslot,t?{timeslotId:t}:"skip"),b=i(o.users.currentUser);return w.useEffect(()=>{},[t,g,x,u]),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-[#1B4332] font-serif",style:{fontFamily:"'Playfair Display', serif"},children:["Welcome",b?.name?`, ${b.name}`:""]}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Order fresh, homely food for pickup or delivery."})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-[#1B4332] font-serif",style:{fontFamily:"'Playfair Display', serif"},children:"Select Delivery Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Time Slot"}),e.jsxs("select",{value:t||"",onChange:s=>{const r=s.target.value;x(r),u(null)},className:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-[#2E7D32] outline-none bg-gray-50 transition-shadow",children:[e.jsx("option",{value:"",disabled:!0,children:"Choose a pickup time..."}),g?.map(s=>{let r=!0;if(s.orderStartTime&&s.orderEndTime){const a=new Date,l=a.getHours().toString().padStart(2,"0"),v=a.getMinutes().toString().padStart(2,"0"),m=`${l}:${v}`;s.orderStartTime<=s.orderEndTime?r=m>=s.orderStartTime&&m<=s.orderEndTime:r=m>=s.orderStartTime||m<=s.orderEndTime}return e.jsxs("option",{value:s._id,children:[s.label," (",s.startTime," - ",s.endTime,") - ",r?"Open":"Closed"]},s._id)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Location"}),e.jsxs("select",{value:c||"",onChange:s=>u(s.target.value),className:"w-full p-3 border rounded-lg focus:ring-2 focus:ring-[#2E7D32] outline-none bg-gray-50 disabled:bg-gray-100 disabled:text-gray-400 transition-shadow",disabled:!t,children:[e.jsx("option",{value:"",disabled:!0,children:t?"Choose a location...":"Select a time slot first..."}),j?.filter(s=>t?g?.find(a=>a._id===t)?.availableLocationIds.includes(s._id):!1).map(s=>e.jsx("option",{value:s._id,children:s.name},s._id))]})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-3xl font-bold text-[#1B4332] font-serif",style:{fontFamily:"'Playfair Display', serif"},children:"Menu"}),f>0&&e.jsxs("div",{className:"flex items-center gap-2 bg-[#E8F5E9] px-4 py-2 rounded-full border border-[#C8E6C9]",children:[e.jsx(E,{className:"w-5 h-5 text-[#2E7D32]"}),e.jsxs("span",{className:"font-semibold text-[#1B4332]",children:[f," ",f===1?"item":"items"," in cart"]})]})]}),t?h?h.length===0?e.jsx("div",{className:"text-center py-12 bg-white rounded-xl",children:e.jsx("p",{className:"text-gray-500",children:"No items available for this time slot."})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:h.map(s=>{const a=y.find(l=>l.id===s._id)?.quantity||0;return e.jsxs("div",{className:"bg-white rounded-xl shadow-sm hover:shadow-md transition-shadow overflow-hidden border border-gray-100 flex flex-col group",children:[e.jsxs("div",{className:`h-48 bg-gray-200 relative overflow-hidden ${s.isAvailable===!1?"grayscale":""}`,children:[e.jsx(I,{storageId:s.imageStorageId,imageUrl:s.imageUrl,name:s.name}),s.isAvailable===!1&&e.jsx("div",{className:"absolute inset-0 bg-black/10 flex items-center justify-center",children:e.jsx("span",{className:"bg-white/90 text-gray-800 px-3 py-1 rounded-full text-sm font-bold shadow-sm",children:"Unavailable"})}),a>0&&s.isAvailable!==!1&&e.jsxs("div",{className:"absolute top-2 right-2 bg-[#2E7D32] text-white px-3 py-1 rounded-full text-sm font-bold shadow-lg",children:[a," in cart"]})]}),e.jsxs("div",{className:"p-5 flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"font-bold text-lg text-gray-900 font-serif",style:{fontFamily:"'Playfair Display', serif"},children:s.name}),e.jsxs("span",{className:"font-bold text-[#2E7D32]",children:["â‚¹",s.sellingPrice]})]}),e.jsx("p",{className:"text-gray-500 text-sm mb-4 line-clamp-2",children:s.description}),e.jsx("div",{className:"mt-auto",children:s.isAvailable===!1?e.jsx("button",{disabled:!0,className:"w-full py-2 font-semibold rounded-lg bg-gray-100 text-gray-400 cursor-not-allowed border border-gray-200",children:"Unavailable"}):a>0?e.jsxs("div",{className:"flex items-center justify-between w-full bg-[#E8F5E9] rounded-lg border border-[#C8E6C9] p-1",children:[e.jsx("button",{onClick:l=>{l.stopPropagation(),d(s._id,a-1)},className:"p-2 hover:bg-[#C8E6C9] rounded-md text-[#1B4332] transition-colors",children:e.jsx(C,{className:"w-4 h-4"})}),e.jsx("span",{className:"font-bold text-[#1B4332]",children:a}),e.jsx("button",{onClick:l=>{l.stopPropagation(),d(s._id,a+1)},className:"p-2 hover:bg-[#C8E6C9] rounded-md text-[#1B4332] transition-colors",children:e.jsx(p,{className:"w-4 h-4"})})]}):e.jsxs("button",{onClick:l=>{l.stopPropagation(),n({id:s._id,name:s.name,price:s.sellingPrice,quantity:1})},className:"w-full py-2 font-semibold rounded-lg transition-colors flex items-center justify-center gap-2 bg-[#E8F5E9] text-[#1B4332] hover:bg-[#C8E6C9]",children:[e.jsx(p,{className:"w-4 h-4"}),"Add to Cart"]})})]})]},s._id)})}):e.jsx("div",{className:"text-center py-12",children:e.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-[#2E7D32] rounded-full border-t-transparent mx-auto"})}):e.jsx("div",{className:"text-center py-12 bg-white rounded-xl border border-dashed border-gray-300",children:e.jsx("p",{className:"text-gray-500",children:"Please select a Location and Time Slot to view the menu."})})]})]})}export{k as default};
